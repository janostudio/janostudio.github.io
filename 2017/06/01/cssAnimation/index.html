<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>css动画 | Janostudio | Everything you see exists together in a delicate balance.</title>

  
  <meta name="author" content="Janathon Jiang">
  

  
  <meta name="description" content="最近，写一个“销售助手”的前端展示页面，因为是纯前端页面以及对兼容性要求不高（不需要考虑IE用户，即IE10即以上版本），所以自由度很大，没有选择用react等前端框架，因为刚开始需求是只要一个页面TAT。页面用原生JS写，目前就用了“html2canvas.js”插件，恩，追求不用插件自己造轮子o">
  

  
  
  <meta name="keywords" content="CSS,animation">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="css动画"/>

  <meta property="og:site_name" content="Janostudio"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Janostudio" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Janostudio</a>
    </h1>
    <p class="site-description">Everything you see exists together in a delicate balance.</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/categories">Categories</a></li>
      
        <li><a href="/tags">Tags</a></li>
      
        <li><a href="/about">About</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>css动画</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2017/06/01/cssAnimation/" rel="bookmark">
        <time class="entry-date published" datetime="2017-06-01T13:37:45.000Z">
          2017-06-01
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>最近，写一个“销售助手”的前端展示页面，因为是纯前端页面以及对兼容性要求不高（不需要考虑IE用户，即IE10即以上版本），所以自由度很大，没有选择用react等前端框架，因为刚开始需求是只要一个页面TAT。页面用原生JS写，目前就用了“html2canvas.js”插件，恩，追求不用插件自己造轮子orz。公司项目为了兼容，动画全部用jQuery写，发现自己对CSS动画相当的生疏，越写越发现CSS动画能力的强大，再次做个记录。</p>
<h2 id="1、-前端动画种类"><a href="#1、-前端动画种类" class="headerlink" title="1、 前端动画种类"></a>1、 前端动画种类</h2><p>前端动画如果用JS（不讨论jQuery，即animate()）书写，主要用<code>setTimeoout(),setTimeInterval(),requestAnimationFrame()</code>（这个还有有用处的，CSS还不能对所有的属性写动画，比如：<code>ScrollTop</code>等）。<br>用CSS写的话，<code>animation</code>配合<code>keyframe</code>可以完成很多复杂的动画，但是使用起来不方便，而<code>transition</code>虽然动画简单但是使用方便，而<code>transform</code>属性虽然英文有“改变”的含义但是它是静态属性。<br>JS动画和CSS动画之间，说的最多的估计就是性能了，然而看文档除了少数属性区别并不大。</p>
<h3 id="1-1-属性"><a href="#1-1-属性" class="headerlink" title="1.1 属性"></a>1.1 属性</h3><p>Chromium项目里，渲染线程分为<code>main thread</code>和<code>compositor thread</code>。对于<code>backface-visibility、opacity、perspective、perspective-origin、transfrom</code>这几个属性，<br>css触发compositor thread 而JS触发 main thread再触发compositor thread，所以用CSS较好。</p>
<blockquote>
<p>在主线程中，维护了一棵Layer树（LayerTreeHost），管理了TiledLayer，在compositor thread，维护了同样一颗LayerTreeHostImpl，管理了LayerImpl，这两棵树的内容是拷贝关系。因此可以彼此不干扰，当Javascript在main thread操作LayerTreeHost的同时，compositor thread可以用LayerTreeHostImpl做渲染。当Javascript繁忙导致主线程卡住时，合成到屏幕的过程也是流畅的。<br>为了实现防假死，鼠标键盘消息会被首先分发到compositor thread，然后再到main thread。这样，当main thread繁忙时，compositor thread还是能够响应一部分消息，例如，鼠标滚动时，加入main thread繁忙，compositor thread也会处理滚动消息，滚动已经被提交的页面部分（未被提交的部分将被刷白）。</p>
</blockquote>
<h3 id="1-2-要注意reflow"><a href="#1-2-要注意reflow" class="headerlink" title="1.2 要注意reflow"></a>1.2 要注意reflow</h3><p>css或是js控制动画，reflow都是必然的，要减少reflow。</p>
<h2 id="2、-CSS触发区别"><a href="#2、-CSS触发区别" class="headerlink" title="2、 CSS触发区别"></a>2、 CSS触发区别</h2><h2 id="2-1-transition"><a href="#2-1-transition" class="headerlink" title="2.1 transition"></a>2.1 transition</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">transition: property duration timing-function delay;</div><div class="line"></div><div class="line">transition: all ease-out 1s;</div><div class="line">-moz-transition: all ease-out 1s; /* Firefox 4 */</div><div class="line">-webkit-transition: all ease-out 1s; /* Safari 和 Chrome */</div><div class="line">-o-transition: all ease-out 1s; /* Opera */</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">值</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">linear</td>
<td style="text-align:left">匀速（等于 cubic-bezier(0,0,1,1)）。</td>
</tr>
<tr>
<td style="text-align:left">ease</td>
<td style="text-align:left">从慢到快再到慢（cubic-bezier(0.25,0.1,0.25,1)）。</td>
</tr>
<tr>
<td style="text-align:left">ease-in</td>
<td style="text-align:left">慢慢变快（等于 cubic-bezier(0.42,0,1,1)）。</td>
</tr>
<tr>
<td style="text-align:left">ease-out</td>
<td style="text-align:left">慢慢变慢（等于 cubic-bezier(0,0,0.58,1)）。</td>
</tr>
<tr>
<td style="text-align:left">ease-in-out</td>
<td style="text-align:left">先变快再到慢（等于 cubic-bezier(0.42,0,0.58,1)）。渐显渐隐效果。</td>
</tr>
<tr>
<td style="text-align:left">cubic-bezier(n,n,n,n)</td>
<td style="text-align:left">在 cubic-bezier 函数中定义自己的值。可能的值是 0 至 1 之间的数值。</td>
</tr>
</tbody>
</table>
<p>当设定的属性改变时，动画就会触发，但是需要注意效率(主要正对减少reflow)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 不好的写法</div><div class="line">el.style.left = &quot;10px&quot;;</div><div class="line">el.style.top  = &quot;10px&quot;;</div><div class="line">el.style.background = &apos;#eee&apos;; </div><div class="line">// 比较好的写法</div><div class="line">el.className += &quot; theclassname&quot;;</div></pre></td></tr></table></figure></p>
<p><strong>如果属性为设置初始值，则第一次不会触发；若要对位置高度的div设置动画可以用max-height来设置。</strong></p>
<h2 id="2-2-animation"><a href="#2-2-animation" class="headerlink" title="2.2 animation"></a>2.2 animation</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">animation:mymove 5s infinite;</div><div class="line">-webkit-animation:mymove 5s infinite; </div><div class="line">@keyframes mymove</div><div class="line">&#123;</div><div class="line">    from &#123;left:0px;&#125;</div><div class="line">    to &#123;left:200px;&#125;</div><div class="line">&#125;</div><div class="line">@-webkit-keyframes mymove </div><div class="line">&#123;</div><div class="line">    from &#123;left:0px;&#125;</div><div class="line">    to &#123;left:200px;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当<code>display</code>属性改变时触发，页面加载时也会触发。</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/css/">css</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/CSS/">CSS</a><a href="/tags/animation/">animation</a>
    </span>
    

    </div>

    
  </div>
</article>


    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2018 Janathon Jiang
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-114538078-1', 'auto');
    ga('send', 'pageview');

</script>

  </div>
</div>
</body>
</html>